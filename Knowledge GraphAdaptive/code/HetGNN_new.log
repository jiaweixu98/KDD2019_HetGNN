nohup: 忽略输入
RuntimeError: module compiled against API version 0xc but this version of numpy is 0xb
RuntimeError: module compiled against API version 0xc but this version of numpy is 0xb
HetGNN.py:38: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if feature_list[i] == '':
------arguments-------
data_path: ../data/academic/
model_path: ../model_save/
A_n: 666080
P_n: 300708
V_n: 506320
in_f_d: 128
embed_d: 128
lr: 0.001
batch_s: 20000
mini_batch_s: 200
train_iter_n: 50
walk_n: 10
walk_L: 30
window: 5
random_seed: 10
train_test_label: 0
save_model_freq: 2
cuda: 0
checkpoint: 
computing sampling ratio for each kind of triple ...
sampling ratio computing finish.
即将实例化模型
model training ...
  0%|          | 0/50 [00:00<?, ?it/s]iteration 0 ...
sampling triple relations ...
9
len(id_batch) 1
id_batch [[ 93548 199624 168927 268406  70012  50865 144282   3006 144283 144282
  462912 584938 344678 584939 309438   8396   4474   3438   8397   8395
    3670   9849 238802  36201   3691  12095  12098 162054  13971  12096
  272866 170240 419810 350054 364445   5714   5713   5716   5718   5715
   20154  20151  20152  20153  20153 194404 422593 169070 572295 572290
  147026 147387 147026 147026 147026  26528 635089  19637 635097 635090
   39780  39782  39781  17931  39783    227  54511  20364    198  30021
   30114  30115  30113  30112  27991  26045  47309  47308  37992  74544
  547912 547915 302542 547913 516019  50107  50110  50109  50108  50109
   52300  85490  52298  52296 310391 183670  24089  99305 370271 341570
   59483  59484  59482 422585  60473 136976 312264 663252   3373 128232
  378246 263283  73438 124829 476932  63110  63087  12678 402970  63109
   49056  49055  49054  49055  49056  54008  44343  25209  54007  54006
   67713  27255  67709  67711  67708   4466   3719   7556  74417  70469
  506569 496056 584607 177044 121048  79054  79741  79054  79054  79741
    2350   1606   1608  35886   3924    212  54036  54037    206    209
   67434 223511  69636 116029  66264  83967  83969  83963  83970  84066
  169040 151614 514762 169037 169036 105257 105255  87444  87441  87442
   48677  48682  48679  48678  48681   1523 101794 101795 101797 101796
  173503 173502 103853  13823 103851  11837 365374 365375 338928  96768
  105341 105334 105342 105336 105339 260851 290986 290984  61925 290983
   79732  23218 102601 258402 103672 107026  91918  67410  91916 241743
  109095 109094 190723 190723 190723 246327  15324 117523 341108 237269
  165904 117884 165901 165897  89876 256614 261002 313602 200810 256612
   15469  61893  72260   5166  21862  88732 123441 123443  94915 286820
    9931 103987  18019  11775 104366 605718 605717 605719 605721 197090
  157320 128760 219911 157319 219913 135644 135649 135650 135648 135645
  138656 138657   6527 139367 154457 140740 140739 140741 140740 140741
  144463 144462 144463 144463 144463  21273 253268 237004 227375  81459
    2114 147714 147715  49375 147548 527142 527138 582907 419710 242173
  153760 153761 153763 153762 153761 154887 154888 154697 138406 138405
  131789 131787 124193 156449 131793  40659  40663  72844 150777 152308
  177981 295546 541140 198626 176738 178769 178767 178768 501863 426107
  444958 180067 180064 130393 588141 335312 551023 301407  65087 514803
   88195  15855  12528 127088  18219 137507 182732 215165 404959 464751
  540623 540625 540634 575493 575492 219360 219350 219366 219355 219354
  380486 182515 152654  18725 358968  87354  21564 255796  88694  90881
  327484 248299 327485 253642 122036 178380  44286 178376 209399 178377
  371909  71593 103952 603788 603786 408818 168534 496779 312932 103620
     203  50217 127800  77008    756 119234 605533 244616  12121  12390
  109073 119751 454589  15935 127032  33116  33117  43634  48553  36532
   41704 223789 250883 220255 341908 542237 542232 542234 457323 256408
  283479 319452 208612 311121 114478 145419 145420 145421 145897 145897
  235305  39294 235306 365463  19311  52686   8055 199469  13634   9776
   83983 130679 237963 237964 237965  12352 247259  57293 247256 123461
  627795 278291 254218 627796 571328  23737  20020  23738  38658  17146
   32114  41821 163487 180217 153295 316742 454286 357012 172374 350327
   14670  94253 188580   5629  17486 272872 272870 272871 272874 272873
  273456 217142 273454 273453 196100 594242 594241 303084 594244 594250
   15772  15775  15774  60651  28780 282327 282329 282326 282325 282328
  451856 456404 160556 279273 524853 180174 180177 101840 127304 128756
  287523 287517 287524  21637 287516  56805 288713 159524 288715 169819
   76075  76076 137539 137537  24164 547404 559555 325190 559553 559554
  301537 301535 493220 301534 301536 292680 308700 308699 342017 308696
  357477 126992  63826 305518 394900 652902 155813 652905 652904 652899
  226632 652288 257732 450240 130334 391105 369238  90830 391104  13536
  622742 622741 287114 622743 457623  13190  13188  71131  14899  80117
   90036 170810 160925 360425 360415  15744 115789  11600 132012 119438
  340812 340814 340817 340811 340813  16145  89468 217855  12104  13423
   55315  11160  55305  12123  12120 165191 361517 344423 103173 593236
   90036 391712 464266 299421  88598  59461 355624 328957 510583 236591
  362022 245100 362011 362019 362017 362172 362173 362174 362170 166407
   65880 368736 299200 187144 424418 181674  91550 181675  91551 181681
  512136  86516  15469 448007 101287    354   1853   2886   6510 468359
   16095  25861  79305 357677  81850 396346 396352 396349 396347 381420
  404127 404130 404129 404126 404128 132105   4578 412690 412687 131090
  253404 415399 308141 415398 384829  12477 317875 420678 103713 123119
  296000 599423 599427 112756 599421 317545 419034 222799 419031 333443
  608185 392131 608186 532606 608190 326810 151316 291120 239423  98873
  190205  78381  40993  42826 190206 257115 257114 186597  72919  78614
  202208 202210 108138 155987  14679 428357 412927 326451 178992 460400
  284092 284094 112665  49468 259150 534036 273301  28136 283895  76757
  199075 646067 425485 305203 505622 183070 654583 654566 167075 123356
  172874 522057 151784 433612  62244 347416  15108 111550  22667  95284
  286144 299451 116030 445787 577188 575049 575048 575050  24091  26882
  149682 149680 410853 410849 410848  76705 468425 468427 468426  76479
  243514 312670 412807 177281 533489 393033 472587 105215 472598 472590
  481364 232359 481371  99392 651743  84279  32608 600790  15784 160161
  572319 428487 572592 514813 572499  33986  33984  33985 325647 646496
  599541 493566  14793 215011 271889 105387 105389 281247 198743 152300
  110923  90963  11678 166550  19003 512175 512174 224870 500742  88080
  519424 519420 519425 125758 519422 529870 529866 276715 647824 647796
  530520 530523 530519 530522 530521  23477   1963   4906   4894  31133
  276501 500507 136223  16224  16179 158182  25579  64058 305953 158183
  277067 277064 277068 271891 277065 149322  32121  67434 109073 167572
  412571 235291 412572  72314 313306 259537  92726 135166 201202 108144
  273633 117149 273643 273642 273641 560612 560617 367325 560613 560616
   70611  70614  70615 228748  70612 227371 227369 227374 152871 227372
  569219 469052 253449 246784  17116  77522 241406 241405 184917  77522
  138212 138214 140143   9043  40751 370247 351394 275232 418711 248329
  582933  23689 605354 582931 605355 298416 585719 585716 585717 149529
  270905 403903 467926 364510 383174 586985 586982 586986 586987 586989
  614318 275526 208157 275527 275530 592444 592442 592443 349269  11230
  592753 592752 592748 592751 592746  96089 243764 427674 221993  70306
  136707  12748 387198 387197  93008  65827   2591  65826  12878  39733
  336700 168194  72420 223834 114559 170346 170338 170345 180811 170344
  610606 610605 354187 354183  18143  17497  17494  17498 167731 168917
  614822 614814 614813 136081 324899  42877 122754 283808 431791 102619
  227955 377136 616655 646640 377134 296723 156171 351595 152559 320212
   12037  96500 202984 174344 280704 259649 174059 235284 190263 342190]]
type(id_batch) <class 'numpy.ndarray'>
batch.shape (1, 1000)
[[ 93548 199624 168927 268406  70012  50865 144282   3006 144283 144282
  462912 584938 344678 584939 309438   8396   4474   3438   8397   8395
    3670   9849 238802  36201   3691  12095  12098 162054  13971  12096
  272866 170240 419810 350054 364445   5714   5713   5716   5718   5715
   20154  20151  20152  20153  20153 194404 422593 169070 572295 572290
  147026 147387 147026 147026 147026  26528 635089  19637 635097 635090
   39780  39782  39781  17931  39783    227  54511  20364    198  30021
   30114  30115  30113  30112  27991  26045  47309  47308  37992  74544
  547912 547915 302542 547913 516019  50107  50110  50109  50108  50109
   52300  85490  52298  52296 310391 183670  24089  99305 370271 341570
   59483  59484  59482 422585  60473 136976 312264 663252   3373 128232
  378246 263283  73438 124829 476932  63110  63087  12678 402970  63109
   49056  49055  49054  49055  49056  54008  44343  25209  54007  54006
   67713  27255  67709  67711  67708   4466   3719   7556  74417  70469
  506569 496056 584607 177044 121048  79054  79741  79054  79054  79741
    2350   1606   1608  35886   3924    212  54036  54037    206    209
   67434 223511  69636 116029  66264  83967  83969  83963  83970  84066
  169040 151614 514762 169037 169036 105257 105255  87444  87441  87442
   48677  48682  48679  48678  48681   1523 101794 101795 101797 101796
  173503 173502 103853  13823 103851  11837 365374 365375 338928  96768
  105341 105334 105342 105336 105339 260851 290986 290984  61925 290983
   79732  23218 102601 258402 103672 107026  91918  67410  91916 241743
  109095 109094 190723 190723 190723 246327  15324 117523 341108 237269
  165904 117884 165901 165897  89876 256614 261002 313602 200810 256612
   15469  61893  72260   5166  21862  88732 123441 123443  94915 286820
    9931 103987  18019  11775 104366 605718 605717 605719 605721 197090
  157320 128760 219911 157319 219913 135644 135649 135650 135648 135645
  138656 138657   6527 139367 154457 140740 140739 140741 140740 140741
  144463 144462 144463 144463 144463  21273 253268 237004 227375  81459
    2114 147714 147715  49375 147548 527142 527138 582907 419710 242173
  153760 153761 153763 153762 153761 154887 154888 154697 138406 138405
  131789 131787 124193 156449 131793  40659  40663  72844 150777 152308
  177981 295546 541140 198626 176738 178769 178767 178768 501863 426107
  444958 180067 180064 130393 588141 335312 551023 301407  65087 514803
   88195  15855  12528 127088  18219 137507 182732 215165 404959 464751
  540623 540625 540634 575493 575492 219360 219350 219366 219355 219354
  380486 182515 152654  18725 358968  87354  21564 255796  88694  90881
  327484 248299 327485 253642 122036 178380  44286 178376 209399 178377
  371909  71593 103952 603788 603786 408818 168534 496779 312932 103620
     203  50217 127800  77008    756 119234 605533 244616  12121  12390
  109073 119751 454589  15935 127032  33116  33117  43634  48553  36532
   41704 223789 250883 220255 341908 542237 542232 542234 457323 256408
  283479 319452 208612 311121 114478 145419 145420 145421 145897 145897
  235305  39294 235306 365463  19311  52686   8055 199469  13634   9776
   83983 130679 237963 237964 237965  12352 247259  57293 247256 123461
  627795 278291 254218 627796 571328  23737  20020  23738  38658  17146
   32114  41821 163487 180217 153295 316742 454286 357012 172374 350327
   14670  94253 188580   5629  17486 272872 272870 272871 272874 272873
  273456 217142 273454 273453 196100 594242 594241 303084 594244 594250
   15772  15775  15774  60651  28780 282327 282329 282326 282325 282328
  451856 456404 160556 279273 524853 180174 180177 101840 127304 128756
  287523 287517 287524  21637 287516  56805 288713 159524 288715 169819
   76075  76076 137539 137537  24164 547404 559555 325190 559553 559554
  301537 301535 493220 301534 301536 292680 308700 308699 342017 308696
  357477 126992  63826 305518 394900 652902 155813 652905 652904 652899
  226632 652288 257732 450240 130334 391105 369238  90830 391104  13536
  622742 622741 287114 622743 457623  13190  13188  71131  14899  80117
   90036 170810 160925 360425 360415  15744 115789  11600 132012 119438
  340812 340814 340817 340811 340813  16145  89468 217855  12104  13423
   55315  11160  55305  12123  12120 165191 361517 344423 103173 593236
   90036 391712 464266 299421  88598  59461 355624 328957 510583 236591
  362022 245100 362011 362019 362017 362172 362173 362174 362170 166407
   65880 368736 299200 187144 424418 181674  91550 181675  91551 181681
  512136  86516  15469 448007 101287    354   1853   2886   6510 468359
   16095  25861  79305 357677  81850 396346 396352 396349 396347 381420
  404127 404130 404129 404126 404128 132105   4578 412690 412687 131090
  253404 415399 308141 415398 384829  12477 317875 420678 103713 123119
  296000 599423 599427 112756 599421 317545 419034 222799 419031 333443
  608185 392131 608186 532606 608190 326810 151316 291120 239423  98873
  190205  78381  40993  42826 190206 257115 257114 186597  72919  78614
  202208 202210 108138 155987  14679 428357 412927 326451 178992 460400
  284092 284094 112665  49468 259150 534036 273301  28136 283895  76757
  199075 646067 425485 305203 505622 183070 654583 654566 167075 123356
  172874 522057 151784 433612  62244 347416  15108 111550  22667  95284
  286144 299451 116030 445787 577188 575049 575048 575050  24091  26882
  149682 149680 410853 410849 410848  76705 468425 468427 468426  76479
  243514 312670 412807 177281 533489 393033 472587 105215 472598 472590
  481364 232359 481371  99392 651743  84279  32608 600790  15784 160161
  572319 428487 572592 514813 572499  33986  33984  33985 325647 646496
  599541 493566  14793 215011 271889 105387 105389 281247 198743 152300
  110923  90963  11678 166550  19003 512175 512174 224870 500742  88080
  519424 519420 519425 125758 519422 529870 529866 276715 647824 647796
  530520 530523 530519 530522 530521  23477   1963   4906   4894  31133
  276501 500507 136223  16224  16179 158182  25579  64058 305953 158183
  277067 277064 277068 271891 277065 149322  32121  67434 109073 167572
  412571 235291 412572  72314 313306 259537  92726 135166 201202 108144
  273633 117149 273643 273642 273641 560612 560617 367325 560613 560616
   70611  70614  70615 228748  70612 227371 227369 227374 152871 227372
  569219 469052 253449 246784  17116  77522 241406 241405 184917  77522
  138212 138214 140143   9043  40751 370247 351394 275232 418711 248329
  582933  23689 605354 582931 605355 298416 585719 585716 585717 149529
  270905 403903 467926 364510 383174 586985 586982 586986 586987 586989
  614318 275526 208157 275527 275530 592444 592442 592443 349269  11230
  592753 592752 592748 592751 592746  96089 243764 427674 221993  70306
  136707  12748 387198 387197  93008  65827   2591  65826  12878  39733
  336700 168194  72420 223834 114559 170346 170338 170345 180811 170344
  610606 610605 354187 354183  18143  17497  17494  17498 167731 168917
  614822 614814 614813 136081 324899  42877 122754 283808 431791 102619
  227955 377136 616655 646640 377134 296723 156171 351595 152559 320212
   12037  96500 202984 174344 280704 259649 174059 235284 190263 342190]]  0%|          | 0/50 [08:21<?, ?it/s]

[tensor([[ 23.9790,  -4.1254,   2.5492,  ...,   2.5081,   1.2268,   1.6896],
        [ 36.6522,  -2.3390,   0.2200,  ...,  -0.8676,  -2.4022,   1.4168],
        [ 28.1100,  -8.2862,   3.2129,  ...,   0.6265,  -1.8818,  -0.5680],
        ...,
        [ 19.1246, -11.7535,  -7.4066,  ...,  -0.6154,   2.3491,  -1.9458],
        [-28.5962,  -0.3490,   1.4494,  ...,   1.8554,  -2.8092,  -2.6025],
        [-20.5330, -18.1941,  -4.7030,  ...,   1.6112,   0.7698,   0.2606]]), '', tensor([[ 0.5612, -0.4006, -0.0594,  ..., -0.3789,  0.6331, -0.1322],
        [-0.1233, -0.3013, -0.4464,  ...,  0.5095,  0.2792, -0.2115],
        [-0.2202, -0.2624, -0.1101,  ...,  0.1256,  0.1535, -0.1869],
        ...,
        [ 0.0956, -0.0612, -0.0949,  ...,  0.0580,  0.1359,  0.1422],
        [-0.0846, -0.1993, -0.1699,  ...,  0.3638,  0.3410, -0.2408],
        [ 0.0257,  0.1188, -0.3298,  ...,  0.2811,  0.0595, -0.0991]]), tensor([[ 0.5181, -0.2942,  0.0611,  ..., -0.2864,  0.3066, -0.0710],
        [ 0.0318, -0.3230, -0.0135,  ...,  0.5581, -0.0034, -0.1832],
        [-0.7752, -0.2821, -0.0457,  ...,  0.3345,  0.5623, -0.4737],
        ...,
        [ 0.1883, -0.1938,  0.0062,  ..., -0.1640, -0.0646, -0.1966],
        [-0.2178, -0.2758, -0.1572,  ...,  0.5192,  0.1746, -0.3526],
        [-0.4294, -0.2961, -0.3754,  ..., -0.0501,  0.4902,  0.5373]]), '', tensor([[ 8.9412e-01, -3.5222e-01,  2.4925e-01,  ..., -5.6776e-01,
          7.7049e-01, -3.5818e-01],
        [-2.9048e-01, -6.1386e-01, -5.5689e-02,  ...,  3.3252e-01,
          3.0642e-01, -1.9620e-01],
        [-5.8661e-01, -3.6499e-01, -3.1810e-03,  ...,  1.6158e-01,
          5.7863e-01, -6.7579e-01],
        ...,
        [ 1.4875e-01, -1.1906e-01,  2.0633e-01,  ...,  6.5000e-04,
          1.3758e-01, -1.9114e-01],
        [-3.5918e-01, -2.0992e-01, -2.4305e-01,  ...,  7.1712e-01,
          1.8388e-01, -5.5805e-01],
        [-3.9456e-01,  3.9541e-01, -6.4695e-01,  ...,  1.5366e-01,
          2.8967e-01,  1.6980e-01]]), tensor([[-0.0594, -0.1008,  0.0223,  ...,  0.1985,  0.4488,  0.0860],
        [-0.1830, -0.2031,  0.2097,  ...,  0.1587,  0.1533, -0.2927],
        [-0.1746, -0.3010, -0.0116,  ...,  0.0502,  0.0701, -0.1851],
        ...,
        [-0.3913, -0.2751, -0.1477,  ...,  0.1644, -0.1919, -0.3596],
        [-0.4886, -0.2217, -0.3014,  ...,  0.2313, -0.2890, -0.2189],
        [ 0.1943, -0.1318, -0.1866,  ...,  0.2443, -0.1081,  0.0063]]), '', tensor([[-0.0951, -0.0069, -0.0388,  ...,  0.2323, -0.0186,  0.1667],
        [ 0.1636,  0.7465, -0.0326,  ...,  0.5982,  0.8304, -0.0030],
        [-0.5985, -0.5755,  0.2479,  ...,  0.1000, -0.1479,  0.6906],
        ...,
        [ 0.1682, -0.0208, -0.2881,  ...,  0.2232,  0.1614,  0.0330],
        [ 0.2355, -0.1784, -0.1511,  ..., -0.1269,  0.1780,  0.0770],
        [ 0.0700,  0.0637,  0.0850,  ..., -0.0143,  0.2132, -0.1285]]), '']
Traceback (most recent call last):
  File "HetGNN.py", line 132, in <module>
    model_object.model_train()
  File "HetGNN.py", line 92, in model_train
    c_out_temp, p_out_temp, n_out_temp = self.model(triple_list_batch, triple_index, iter_i)
  File "/home/2101211734_kd/condaEnvs/env_pytorch/lib/python3.6/site-packages/torch/nn/modules/module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/2101211734_kd/xjw/GNN/GNN_Adaptive/code/tools.py", line 334, in forward
    c_out, p_out, n_out = self.aggregate_all(triple_list_batch, triple_index, iter_i)
  File "/home/2101211734_kd/xjw/GNN/GNN_Adaptive/code/tools.py", line 328, in aggregate_all
    c_agg, pos_agg, neg_agg = self.het_agg(triple_index, c_id_batch, pos_id_batch, neg_id_batch, iter_i)
  File "/home/2101211734_kd/xjw/GNN/GNN_Adaptive/code/tools.py", line 228, in het_agg
    c_agg = self.node_het_agg(c_id_batch, 1)
  File "/home/2101211734_kd/xjw/GNN/GNN_Adaptive/code/tools.py", line 181, in node_het_agg
    a_agg_batch = self.node_neigh_agg(a_neigh_batch, 1)
  File "/home/2101211734_kd/xjw/GNN/GNN_Adaptive/code/tools.py", line 146, in node_neigh_agg
    neigh_agg = self.a_content_agg(id_batch).view(batch_s, 5, embed_d)
  File "/home/2101211734_kd/xjw/GNN/GNN_Adaptive/code/tools.py", line 88, in a_content_agg
    a_text_embed_batch_2 = self.feature_list[7][id_batch, embed_d : embed_d * 2][0]
TypeError: string indices must be integers
